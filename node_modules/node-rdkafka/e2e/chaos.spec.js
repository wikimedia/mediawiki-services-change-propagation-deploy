var Kafka = require('../');

var consumer1 = Kafka.KafkaConsumer({
  'bootstrap.servers': 'localhost:9093',
  'group.id': 'kafka-chaos-consumer'
}, {
  'auto.offset.reset': 'earliest'
});

var consumer2 = Kafka.KafkaConsumer({
  'bootstrap.servers': 'localhost:9093',
  'group.id': 'kafka-chaos-consumer'
}, {
  'auto.offset.reset': 'earliest'
});

consumer1.connect({ timeout: 30000 }, function(err, metadata) {
  console.log(metadata);
  console.log(err);
  if (!err) {
    // consumer1.disconnect();
    consumer1.consume([/^telemetry-v2-ingest/], function(err, message) {
      console.log(consumer1.assignments());
      console.log('Got a message');
    });
  }
});
